#[derive(Clone, Copy, PartialEq, Eq)]
#[repr(C)]
pub struct Guid(u32, u16, u16, [u8; 8]);

impl core::fmt::Debug for Guid {
    fn fmt(&self, f: &mut core::fmt::Formatter) -> core::fmt::Result {
        let table_name = self.as_str();

        if table_name == "Unknown" {
            return f.write_fmt(format_args!(
                "Guid(0x{:x}, 0x{:x}, 0x{:x}, {:?}",
                self.0, self.1, self.2, self.3,
            ));
        }

        return f.debug_tuple("Guid").field(&table_name).finish();
    }
}

macro_rules! impl_guids {
    {
        $($name:ident = { $a:literal, $b:literal, $c:literal, { $($d:literal),+ }},)*
    } => {
        impl Guid {
            $(pub const $name: Guid = Guid($a, $b, $c, [$($d,)*]);)*

            pub fn as_str(self) -> &'static str {
                match self {
                    $(Guid::$name => stringify!($name),)*
                    _ => "Unknown",
                }
            }
        }
    }
}

impl_guids! {
    EFI_MEMORY_ATTRIBUTES_TABLE =
        {0xdcfa911d, 0x26eb, 0x469f, {0xa2,0x20,0x38,0xb7,0xdc,0x46,0x12,0x20}},
    EFI_HII_PACKAGE_LIST_PROTOCOL =
        {0x6a1ee763, 0xd47a, 0x43b4, {0xaa,0xbe,0xef,0x1d,0xe2,0xab,0x56,0xfc}},
    EFI_BOOT_MANAGER_POLICY_PROTOCOL =
        {0xFEDF8E0C, 0xE147, 0x11E3, {0x99,0x03,0xB8,0xE8,0x56,0x2C,0xBA,0xFA}},
    EFI_BOOT_MANAGER_POLICY_CONSOLE =
        {0xCAB0E94C, 0xE15F, 0x11E3, {0x91,0x8D,0xB8,0xE8,0x56,0x2C,0xBA,0xFA}},
    EFI_BOOT_MANAGER_POLICY_NETWORK =
        {0xD04159DC, 0xE15F, 0x11E3, {0xB2,0x61,0xB8,0xE8,0x56,0x2C,0xBA,0xFA}},
    EFI_BOOT_MANAGER_POLICY_CONNECT_ALL =
        {0x113B2126, 0xFC8A, 0x11E3, {0xBD,0x6C,0xB8,0xE8,0x56,0x2C,0xBA,0xFA}},

    EFI_ACPI_20_TABLE =
        {0x8868e871,0xe4f1,0x11d3, {0xbc,0x22,0x00,0x80,0xc7,0x3c,0x88,0x81}},
    ACPI_TABLE =
        {0xeb9d2d30,0x2d88,0x11d3, {0x9a,0x16,0x00,0x90,0x27,0x3f,0xc1,0x4d}},
    SAL_SYSTEM_TABLE =
        {0xeb9d2d32,0x2d88,0x11d3, {0x9a,0x16,0x00,0x90,0x27,0x3f,0xc1,0x4d}},
    SMBIOS_TABLE =
        {0xeb9d2d31,0x2d88,0x11d3, {0x9a,0x16,0x00,0x90,0x27,0x3f,0xc1,0x4d}},
    SMBIOS3_TABLE =
        {0xf2fd1544,0x9794,0x4a2c, {0x99,0x2e,0xe5,0xbb,0xcf,0x20,0xe3,0x94}},
    MPS_TABLE =
        {0xeb9d2d2f,0x2d88,0x11d3, {0x9a,0x16,0x00,0x90,0x27,0x3f,0xc1,0x4d}},

    EFI_DEBUG_IMAGE_INFO_TABLE =
        {0x49152E77,0x1ADA,0x4764, {0xB7,0xA2,0x7A,0xFE,0xFE,0xD9,0x5E,0x8B}},

    EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL =
        {0x387477c2,0x69c7,0x11d2, {0x8e,0x39,0x00,0xa0,0xc9,0x69,0x72,0x3b}},
    EFI_GRAPHICS_OUTPUT_PROTOCOL =
        {0x9042a9de,0x23dc,0x4a38, {0x96,0xfb,0x7a,0xde,0xd0,0x80,0x51,0x6a}},
    EFI_SERIAL_IO_PROTOCOL =
        {0xBB25CF6F,0xF1D4,0x11D2, {0x9a,0x0c,0x00,0x90,0x27,0x3f,0xc1,0xfd}},


    // From https://github.com/torvalds/linux/blob/master/include/linux/efi.h
    NULL                                = {0x00000000, 0x0000, 0x0000, {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}},
    UGA_IO_PROTOCOL                     = {0x61a4d49e, 0x6f68, 0x4f1b, {0xb9, 0x22, 0xa8, 0x6e, 0xed, 0x0b, 0x07, 0xa2}},
    EFI_GLOBAL_VARIABLE                 = {0x8be4df61, 0x93ca, 0x11d2, {0xaa, 0x0d, 0x00, 0xe0, 0x98, 0x03, 0x2b, 0x8c}},
    UV_SYSTEM_TABLE                     = {0x3b13a7d4, 0x633e, 0x11dd, {0x93, 0xec, 0xda, 0x25, 0x56, 0xd8, 0x95, 0x93}},
    LINUX_EFI_CRASH                     = {0xcfc8fc79, 0xbe2e, 0x4ddc, {0x97, 0xf0, 0x9f, 0x98, 0xbf, 0xe2, 0x98, 0xa0}},
    LOADED_IMAGE_PROTOCOL               = {0x5b1b31a1, 0x9562, 0x11d2, {0x8e, 0x3f, 0x00, 0xa0, 0xc9, 0x69, 0x72, 0x3b}},
    LOADED_IMAGE_DEVICE_PATH_PROTOCOL   = {0xbc62157e, 0x3e33, 0x4fec, {0x99, 0x20, 0x2d, 0x3b, 0x36, 0xd7, 0x50, 0xdf}},
    EFI_DEVICE_PATH_PROTOCOL            = {0x09576e91, 0x6d3f, 0x11d2, {0x8e, 0x39, 0x00, 0xa0, 0xc9, 0x69, 0x72, 0x3b}},
    EFI_DEVICE_PATH_TO_TEXT_PROTOCOL    = {0x8b843e20, 0x8132, 0x4852, {0x90, 0xcc, 0x55, 0x1a, 0x4e, 0x4a, 0x7f, 0x1c}},
    EFI_DEVICE_PATH_FROM_TEXT_PROTOCOL  = {0x05c99a21, 0xc70f, 0x4ad2, {0x8a, 0x5f, 0x35, 0xdf, 0x33, 0x43, 0xf5, 0x1e}},
    EFI_UGA_PROTOCOL                    = {0x982c298b, 0xf4fa, 0x41cb, {0xb8, 0x38, 0x77, 0xaa, 0x68, 0x8f, 0xb8, 0x39}},
    EFI_PCI_IO_PROTOCOL                 = {0x4cf5b200, 0x68b8, 0x4ca5, {0x9e, 0xec, 0xb2, 0x3e, 0x3f, 0x50, 0x02, 0x9a}},
    EFI_FILE_INFO_ID                    = {0x09576e92, 0x6d3f, 0x11d2, {0x8e, 0x39, 0x00, 0xa0, 0xc9, 0x69, 0x72, 0x3b}},
    EFI_SYSTEM_RESOURCE_TABLE           = {0xb122a263, 0x3661, 0x4f68, {0x99, 0x29, 0x78, 0xf8, 0xb0, 0xd6, 0x21, 0x80}},
    EFI_FILE_SYSTEM                     = {0x964e5b22, 0x6459, 0x11d2, {0x8e, 0x39, 0x00, 0xa0, 0xc9, 0x69, 0x72, 0x3b}},
    DEVICE_TREE                         = {0xb1b621d5, 0xf19c, 0x41a5, {0x83, 0x0b, 0xd9, 0x15, 0x2c, 0x69, 0xaa, 0xe0}},
    EFI_PROPERTIES_TABLE                = {0x880aaca3, 0x4adc, 0x4a04, {0x90, 0x79, 0xb7, 0x47, 0x34, 0x08, 0x25, 0xe5}},
    EFI_RNG_PROTOCOL                    = {0x3152bca5, 0xeade, 0x433d, {0x86, 0x2e, 0xc0, 0x1c, 0xdc, 0x29, 0x1f, 0x44}},
    EFI_RNG_ALGORITHM_RAW               = {0xe43176d7, 0xb6e8, 0x4827, {0xb7, 0x84, 0x7f, 0xfd, 0xc4, 0xb6, 0x85, 0x61}},
    EFI_CONSOLE_OUT_DEVICE              = {0xd3b36f2c, 0xd551, 0x11d4, {0x9a, 0x46, 0x00, 0x90, 0x27, 0x3f, 0xc1, 0x4d}},
    APPLE_PROPERTIES_PROTOCOL           = {0x91bd12fe, 0xf6c3, 0x44fb, {0xa5, 0xb7, 0x51, 0x22, 0xab, 0x30, 0x3a, 0xe0}},
    APPLE_SET_OS_PROTOCOL               = {0xc5c5da95, 0x7d5c, 0x45e6, {0xb2, 0xf1, 0x3f, 0xd5, 0x2b, 0xb1, 0x00, 0x77}},
    EFI_TCG2_PROTOCOL                   = {0x607f766c, 0x7455, 0x42be, {0x93, 0x0b, 0xe4, 0xd7, 0x6d, 0xb2, 0x72, 0x0f}},
    EFI_TCG2_FINAL_EVENTS_TABLE         = {0x1e2ed096, 0x30e2, 0x4254, {0xbd, 0x89, 0x86, 0x3b, 0xbe, 0xf8, 0x23, 0x25}},
    EFI_LOAD_FILE_PROTOCOL              = {0x56ec3091, 0x954c, 0x11d2, {0x8e, 0x3f, 0x00, 0xa0, 0xc9, 0x69, 0x72, 0x3b}},
    EFI_LOAD_FILE2_PROTOCOL             = {0x4006c0c1, 0xfcb3, 0x403e, {0x99, 0x6d, 0x4a, 0x6c, 0x87, 0x24, 0xe0, 0x6d}},
    EFI_RT_PROPERTIES_TABLE             = {0xeb66918a, 0x7eef, 0x402a, {0x84, 0x2e, 0x93, 0x1d, 0x21, 0xc3, 0x8a, 0xe9}},
    EFI_DXE_SERVICES_TABLE              = {0x05ad34ba, 0x6f02, 0x4214, {0x95, 0x2e, 0x4d, 0xa0, 0x39, 0x8e, 0x2b, 0xb9}},
    EFI_SMBIOS_PROTOCOL                 = {0x03583ff6, 0xcb36, 0x4940, {0x94, 0x7e, 0xb9, 0xb3, 0x9f, 0x4a, 0xfa, 0xf7}},
    EFI_MEMORY_ATTRIBUTE_PROTOCOL       = {0xf4560cf6, 0x40ec, 0x4b4a, {0xa1, 0x92, 0xbf, 0x1d, 0x57, 0xd0, 0xb1, 0x89}},
    EFI_IMAGE_SECURITY_DATABASE         = {0xd719b2cb, 0x3d3a, 0x4596, {0xa3, 0xbc, 0xda, 0xd0, 0x0e, 0x67, 0x65, 0x6f}},
    EFI_SHIM_LOCK                       = {0x605dab50, 0xe046, 0x4300, {0xab, 0xb6, 0x3d, 0xd8, 0x10, 0xdd, 0x8b, 0x23}},
    EFI_CERT_SHA256                     = {0xc1c41626, 0x504c, 0x4092, {0xac, 0xa9, 0x41, 0xf9, 0x36, 0x93, 0x43, 0x28}},
    EFI_CERT_X509                       = {0xa5c059a1, 0x94e4, 0x4aa7, {0x87, 0xb5, 0xab, 0x15, 0x5c, 0x2b, 0xf0, 0x72}},
    EFI_CERT_X509_SHA256                = {0x3bd2a492, 0x96c0, 0x4079, {0xb4, 0x20, 0xfc, 0xf9, 0x8e, 0xf1, 0x03, 0xed}},
    EFI_CC_BLOB                         = {0x067b1f5f, 0xcf26, 0x44c5, {0x85, 0x54, 0x93, 0xd7, 0x77, 0x91, 0x2d, 0x42}},
    EFI_CC_MEASUREMENT_PROTOCOL         = {0x96751a3d, 0x72f4, 0x41a6, {0xa7, 0x94, 0xed, 0x5d, 0x0e, 0x67, 0xae, 0x6b}},
    EFI_CC_FINAL_EVENTS_TABLE           = {0xdd4a4648, 0x2de7, 0x4665, {0x96, 0x4d, 0x21, 0xd9, 0xef, 0x5f, 0xb4, 0x46}},
    LINUX_EFI_SCREEN_INFO_TABLE         = {0xe03fc20a, 0x85dc, 0x406e, {0xb9, 0x0e, 0x4a, 0xb5, 0x02, 0x37, 0x1d, 0x95}},
    LINUX_EFI_ARM_CPU_STATE_TABLE       = {0xef79e4aa, 0x3c3d, 0x4989, {0xb9, 0x02, 0x07, 0xa9, 0x43, 0xe5, 0x50, 0xd2}},
    LINUX_EFI_LOADER_ENTRY              = {0x4a67b082, 0x0a4c, 0x41cf, {0xb6, 0xc7, 0x44, 0x0b, 0x29, 0xbb, 0x8c, 0x4f}},
    LINUX_EFI_RANDOM_SEED_TABLE         = {0x1ce1e5bc, 0x7ceb, 0x42f2, {0x81, 0xe5, 0x8a, 0xad, 0xf1, 0x80, 0xf5, 0x7b}},
    LINUX_EFI_TPM_EVENT_LOG             = {0xb7799cb0, 0xeca2, 0x4943, {0x96, 0x67, 0x1f, 0xae, 0x07, 0xb7, 0x47, 0xfa}},
    LINUX_EFI_MEMRESERVE_TABLE          = {0x888eb0c6, 0x8ede, 0x4ff5, {0xa8, 0xf0, 0x9a, 0xee, 0x5c, 0xb9, 0x77, 0xc2}},
    LINUX_EFI_INITRD_MEDIA              = {0x5568e427, 0x68fc, 0x4f3d, {0xac, 0x74, 0xca, 0x55, 0x52, 0x31, 0xcc, 0x68}},
    LINUX_EFI_MOK_VARIABLE_TABLE        = {0xc451ed2b, 0x9694, 0x45d3, {0xba, 0xba, 0xed, 0x9f, 0x89, 0x88, 0xa3, 0x89}},
    LINUX_EFI_COCO_SECRET_AREA          = {0xadf956ad, 0xe98c, 0x484c, {0xae, 0x11, 0xb5, 0x1c, 0x7d, 0x33, 0x64, 0x47}},
    LINUX_EFI_BOOT_MEMMAP               = {0x800f683f, 0xd08b, 0x423a, {0xa2, 0x93, 0x96, 0x5c, 0x3c, 0x6f, 0xe2, 0xb4}},
    LINUX_EFI_UNACCEPTED_MEM_TABLE      = {0xd5d1de3c, 0x105c, 0x44f9, {0x9e, 0xa9, 0xbc, 0xef, 0x98, 0x12, 0x00, 0x31}},
    RISCV_EFI_BOOT_PROTOCOL             = {0xccd15fec, 0x6f73, 0x4eec, {0x83, 0x95, 0x3e, 0x69, 0xe4, 0xb9, 0x40, 0xbf}},
    LINUX_EFI_LOADED_IMAGE_FIXED        = {0xf5a37b6d, 0x3344, 0x42a5, {0xb6, 0xbb, 0x97, 0x86, 0x48, 0xc1, 0x89, 0x0a}},
    DELLEMC_EFI_RCI2_TABLE              = {0x2d9f28a2, 0xa886, 0x456a, {0x97, 0xa8, 0xf1, 0x1e, 0xf2, 0x4f, 0xf4, 0x55}},
    AMD_SEV_MEM_ENCRYPT                 = {0x0cf29b71, 0x9e51, 0x433a, {0xa3, 0xb7, 0x81, 0xf3, 0xab, 0x16, 0xb8, 0x75}},
    OVMF_SEV_MEMORY_ACCEPTANCE_PROTOCOL = {0xc5a010fe, 0x38a7, 0x4531, {0x8a, 0x4a, 0x05, 0x00, 0xd2, 0xfd, 0x16, 0x49}},
}
