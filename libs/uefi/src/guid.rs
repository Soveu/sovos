#[derive(Clone, Copy, PartialEq, Eq)]
#[repr(C)]
pub struct Guid(u32, u16, u16, [u8; 8]);

impl core::fmt::Debug for Guid {
    fn fmt(&self, f: &mut core::fmt::Formatter) -> core::fmt::Result {
        let table_name = self.as_str();

        if table_name == "Unknown" {
            return f.write_fmt(format_args!(
                "Guid(0x{:x}, 0x{:x}, 0x{:x}, {:?}",
                self.0, self.1, self.2, self.3,
            ));
        }

        return f.debug_tuple("Guid").field(&table_name).finish();
    }
}

macro_rules! impl_guids {
    {
        $($name:ident = { $a:literal, $b:literal, $c:literal, { $($d:literal),+ }},)*
    } => {
        impl Guid {
            $(pub const $name: Guid = Guid($a, $b, $c, [$($d,)*]);)*

            pub fn as_str(self) -> &'static str {
                match self {
                    $(Guid::$name => stringify!($name),)*
                    _ => "Unknown",
                }
            }
        }
    }
}

impl_guids! {
    EFI_MEMORY_ATTRIBUTES_TABLE =
        {0xdcfa911d, 0x26eb, 0x469f, {0xa2,0x20,0x38,0xb7,0xdc,0x46,0x12,0x20}},
    EFI_HII_PACKAGE_LIST_PROTOCOL =
        {0x6a1ee763, 0xd47a, 0x43b4, {0xaa,0xbe,0xef,0x1d,0xe2,0xab,0x56,0xfc}},
    EFI_BOOT_MANAGER_POLICY_PROTOCOL =
        {0xFEDF8E0C, 0xE147, 0x11E3, {0x99,0x03,0xB8,0xE8,0x56,0x2C,0xBA,0xFA}},
    EFI_BOOT_MANAGER_POLICY_CONSOLE =
        {0xCAB0E94C, 0xE15F, 0x11E3, {0x91,0x8D,0xB8,0xE8,0x56,0x2C,0xBA,0xFA}},
    EFI_BOOT_MANAGER_POLICY_NETWORK =
        {0xD04159DC, 0xE15F, 0x11E3, {0xB2,0x61,0xB8,0xE8,0x56,0x2C,0xBA,0xFA}},
    EFI_BOOT_MANAGER_POLICY_CONNECT_ALL =
        {0x113B2126, 0xFC8A, 0x11E3, {0xBD,0x6C,0xB8,0xE8,0x56,0x2C,0xBA,0xFA}},

    EFI_ACPI_20_TABLE =
        {0x8868e871,0xe4f1,0x11d3, {0xbc,0x22,0x00,0x80,0xc7,0x3c,0x88,0x81}},
    ACPI_TABLE =
        {0xeb9d2d30,0x2d88,0x11d3, {0x9a,0x16,0x00,0x90,0x27,0x3f,0xc1,0x4d}},
    SAL_SYSTEM_TABLE =
        {0xeb9d2d32,0x2d88,0x11d3, {0x9a,0x16,0x00,0x90,0x27,0x3f,0xc1,0x4d}},
    SMBIOS_TABLE =
        {0xeb9d2d31,0x2d88,0x11d3, {0x9a,0x16,0x00,0x90,0x27,0x3f,0xc1,0x4d}},
    SMBIOS3_TABLE =
        {0xf2fd1544,0x9794,0x4a2c, {0x99,0x2e,0xe5,0xbb,0xcf,0x20,0xe3,0x94}},
    MPS_TABLE =
        {0xeb9d2d2f,0x2d88,0x11d3, {0x9a,0x16,0x00,0x90,0x27,0x3f,0xc1,0x4d}},

    EFI_DEBUG_IMAGE_INFO_TABLE =
        {0x49152E77,0x1ADA,0x4764, {0xB7,0xA2,0x7A,0xFE,0xFE,0xD9,0x5E,0x8B}},

    EFI_SIMPLE_TEXT_OUTPUT_PROTOCOL_GUID =
        {0x387477c2,0x69c7,0x11d2, {0x8e,0x39,0x00,0xa0,0xc9,0x69,0x72,0x3b}},
}
